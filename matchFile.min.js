/*! match-file-utility 2016-04-27 */
function matchFile(a,b){function c(a){return function(){var b=matchFile.fn[a].apply(null,[d].concat([].slice.call(arguments)));return"pipe"===a?d.push.apply(d,b):(d.operations.push({name:a,arguments:[].slice.call(arguments)}),[].splice.apply(d,[0,d.length].concat(b))),d}}var d=[];d.operations=[];for(var e in matchFile.fn)d[e]=c(e);return matchFile.chain(d,a,b)}fs=require("fs"),path=require("path"),matchFile.fn={},"object"==typeof module&&(module.exports=matchFile),matchFile.chain=function(a,b,c){return[].splice.apply(a,[0,a.length].concat(matchFile.find(b,c))),a.match=c,a},matchFile.find=function(a,b){function c(a){var e=fs.readdirSync(a);e.forEach(function(e){var f,g=path.join(a,e);fs.lstatSync(g).isDirectory()?c(g):b.test(e)&&(f=e.match(b),f.length>1&&(f=f.slice(1)),d.push(g))})}var d=[];return c(a),d},matchFile.fn.filter=function(a,b){for(var c=a.length-1;c>=0;c--)b(a[c],c,a)||a.splice(c,1);return a},matchFile.fn.pipe=function(a,b,c){for(var d,e,f=matchFile.find(b,c),g=0,h=a.operations.length;h>g;g++)d=matchFile.fn[a.operations[g].name],e=a.operations[g].arguments,f=d.apply(null,[f].concat(e));return f},matchFile.fn.rename=function(a,b){return a.forEach(function(c,d){var e=path.basename(c).match(a.match),f=b.replace(/\$([a-zA-Z0-9]+)/g,function(a,b){return"dir"===b?path.dirname(c):"filename"===b?path.basename(c):isNaN(Number(b))?void 0:e[Number(b)]});fs.rename(c,f),a[d]=f}),a},matchFile.fn.smartSort=function(a){function b(a,b){return a.length>2&&a.length===b.length&&a.slice(0,-2).join("")===b.slice(0,-2).join("")?"min"===a.slice(-2)[0]?-1:"min"===b.slice(-2)[0]?1:"mobile"===a.slice(-2)[0]?1:"mobile"===b.slice(-2)[0]?-1:a.slice(-2).join("")>b.slice(-2).join("")?1:a.slice(-2).join("")<b.slice(-2).join("")?-1:0:a.join("")>b.join("")?1:-1}function c(a,c){var d=path.basename(a),e=path.basename(c),f=d.match(/[a-zA-Z0-9]+/g),g=e.match(/[a-zA-Z0-9]+/g);return/^init\.[a-z]+$/.test(d)?1:/^init\.[a-z]+$/.test(e)?-1:f.length===g.length?b(f,g):f.length>g.length?1:f.length<g.length?-1:d>e?1:-1}function d(a,b){var c=a.split(path.sep),d=b.split(path.sep);return c.slice(0,-2).join(path.sep)===d.slice(0,-1).join(path.sep)?1:c.slice(0,-1).join(path.sep)===d.slice(0,-2).join(path.sep)?-1:a>b?1:b>a?-1:void 0}return a.sort(function(a,b){return path.dirname(a)===path.dirname(b)?c(a,b):d(a,b)}),a};